<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kompas Kiblat 3D Premium</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">
<style>
body{
Â Â Â Â margin:0;
Â Â Â Â background:radial-gradient(circle at top,#0f172a,#020617);
Â Â Â Â color:white;
Â Â Â Â font-family:system-ui;
Â Â Â Â display:flex;
Â Â Â Â flex-direction:column;
Â Â Â Â align-items:center;
}
#compass{
Â Â Â Â width:340px;
Â Â Â Â height:340px;
Â Â Â Â margin-top:30px;
Â Â Â Â position:relative;
Â Â Â Â perspective:1000px;
}
.disk{
Â Â Â Â width:100%;
Â Â Â Â height:100%;
Â Â Â Â border-radius:50%;
Â Â Â Â background:linear-gradient(145deg,#1e293b,#0f172a);
Â Â Â Â box-shadow:
Â Â Â Â Â Â Â Â inset 0 0 40px rgba(255,255,255,0.05),
Â Â Â Â Â Â Â Â 0 20px 40px rgba(0,0,0,0.6);
Â Â Â Â position:absolute;
}
.cardinal{
Â Â Â Â position:absolute;
Â Â Â Â font-weight:bold;
Â Â Â Â font-size:28px;
Â Â Â Â text-shadow:0 3px 6px black;
}
.N{top:10px;left:50%;transform:translateX(-50%);}
.S{bottom:10px;left:50%;transform:translateX(-50%);}
.E{right:10px;top:50%;transform:translateY(-50%);}
.W{left:10px;top:50%;transform:translateY(-50%);}
#needle{
Â Â Â Â width:6px;
Â Â Â Â height:160px;
Â Â Â Â position:absolute;
Â Â Â Â top:50%;
Â Â Â Â left:50%;
Â Â Â Â transform-origin:50% 100%;
Â Â Â Â transform:translate(-50%,-100%) rotate(0deg);
Â Â Â Â transition:transform 0.1s linear;
}
.red{
Â Â Â Â background:linear-gradient(to top,#b91c1c,#ef4444);
Â Â Â Â height:50%;
}
.white{
Â Â Â Â background:linear-gradient(to bottom,#ffffff,#cbd5e1);
Â Â Â Â height:50%;
}
.kabah{
Â Â Â Â width:18px;
Â Â Â Â height:18px;
Â Â Â Â background:black;
Â Â Â Â border:2px solid gold;
Â Â Â Â position:absolute;
Â Â Â Â top:-10px;
Â Â Â Â left:50%;
Â Â Â Â transform:translateX(-50%);
Â Â Â Â box-shadow:0 0 10px gold;
}
.info{
Â Â Â Â margin-top:25px;
Â Â Â Â text-align:center;
Â Â Â Â font-size:14px;
Â Â Â Â line-height:1.6;
Â Â Â Â opacity:0.9;
}
.globe{
Â Â Â Â width:60px;
Â Â Â Â height:60px;
Â Â Â Â border-radius:50%;
Â Â Â Â background:radial-gradient(circle at 30% 30%,#3b82f6,#0ea5e9,#1e3a8a);
Â Â Â Â margin-top:15px;
Â Â Â Â box-shadow:0 0 15px #0ea5e9;
}
button{
Â Â Â Â margin-top:15px;
Â Â Â Â padding:10px 18px;
Â Â Â Â border:none;
Â Â Â Â border-radius:20px;
Â Â Â Â background:#22c55e;
Â Â Â Â color:black;
Â Â Â Â font-weight:bold;
}
</style>
</head>
<body>
<h2>ğŸ•‹ Kompas Kiblat 3D</h2>
<div id="compass">
Â Â Â Â <div class="disk"></div>
Â Â Â Â <div class="cardinal N">N</div>
Â Â Â Â <div class="cardinal E">E</div>
Â Â Â Â <div class="cardinal S">S</div>
Â Â Â Â <div class="cardinal W">W</div>
Â Â Â Â <div id="needle">
Â Â Â Â Â Â Â Â <div class="red"></div>
Â Â Â Â Â Â Â Â <div class="white"></div>
Â Â Â Â Â Â Â Â <div class="kabah"></div>
Â Â Â Â </div>
</div>
<div class="globe"></div>
<div class="info">
Â Â Â Â ğŸ“ Koordinat: <span id="coord">-</span><br>
Â Â Â Â ğŸ“ Derajat Kiblat: <span id="degree">-</span>Â°<br>
Â Â Â Â ğŸ§­ Selisih Sudut: <span id="diff">-</span>Â°<br>
Â Â Â Â ğŸŒ Jarak ke Mekkah: <span id="distance">-</span> km
</div>
<button onclick="requestPermission()">Aktifkan Sensor</button>
<script>
const KAABA_LAT = 21.4225;
const KAABA_LON = 39.8262;
let userLat = null;
let userLon = null;
let heading = 0;
let qibla = 0;
let currentRotation = 0;
function toRad(deg){ return deg * Math.PI / 180; }
function toDeg(rad){ return rad * 180 / Math.PI; }
function getDistance(lat1, lon1, lat2, lon2){
Â Â Â Â const R = 6371;
Â Â Â Â const dLat = toRad(lat2-lat1);
Â Â Â Â const dLon = toRad(lon2-lon1);
Â Â Â Â const a = Math.sin(dLat/2)**2 +
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Math.sin(dLon/2)**2;
Â Â Â Â return (R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)));
}
function getQiblaDirection(lat, lon){
Â Â Â Â const dLon = toRad(KAABA_LON - lon);
Â Â Â Â const y = Math.sin(dLon);
Â Â Â Â const x = Math.cos(toRad(lat))*Math.tan(toRad(KAABA_LAT))
Â Â Â Â Â Â Â Â Â Â Â Â - Math.sin(toRad(lat))*Math.cos(dLon);
Â Â Â Â return (toDeg(Math.atan2(y,x)) + 360) % 360;
}
// Animasi smooth
function animate(){
Â Â Â Â let target = qibla - heading;
Â Â Â Â currentRotation += (target - currentRotation) * 0.08;
Â Â Â Â document.getElementById("needle").style.transform =
Â Â Â Â Â Â Â Â `translate(-50%,-100%) rotate(${currentRotation}deg)`;
Â Â Â Â requestAnimationFrame(animate);
}
animate();
// GPS
navigator.geolocation.getCurrentPosition(
Â Â Â Â pos=>{
Â Â Â Â Â Â Â Â userLat = pos.coords.latitude;
Â Â Â Â Â Â Â Â userLon = pos.coords.longitude;
Â Â Â Â Â Â Â Â document.getElementById("coord").textContent =
Â Â Â Â Â Â Â Â Â Â Â Â userLat.toFixed(5)+", "+userLon.toFixed(5);
Â Â Â Â Â Â Â Â qibla = getQiblaDirection(userLat,userLon);
Â Â Â Â Â Â Â Â document.getElementById("degree").textContent =
Â Â Â Â Â Â Â Â Â Â Â Â qibla.toFixed(2);
Â Â Â Â Â Â Â Â let dist = getDistance(userLat,userLon,KAABA_LAT,KAABA_LON);
Â Â Â Â Â Â Â Â document.getElementById("distance").textContent =
Â Â Â Â Â Â Â Â Â Â Â Â dist.toFixed(1);
Â Â Â Â },
Â Â Â Â err=>{
Â Â Â Â Â Â Â Â alert("GPS gagal: aktifkan lokasi & HTTPS");
Â Â Â Â },
Â Â Â Â {enableHighAccuracy:true}
);
// SENSOR (fallback universal)
function handleOrientation(e){
Â Â Â Â if(e.absolute === true || e.webkitCompassHeading){
Â Â Â Â Â Â Â Â heading = e.webkitCompassHeading || (360 - e.alpha);
Â Â Â Â } else {
Â Â Â Â Â Â Â Â heading = 360 - e.alpha;
Â Â Â Â }
Â Â Â Â let diff = Math.abs(qibla - heading);
Â Â Â Â document.getElementById("diff").textContent =
Â Â Â Â Â Â Â Â diff.toFixed(2);
}
window.addEventListener("deviceorientation", handleOrientation, true);
// Permission iOS
function requestPermission(){
Â Â Â Â if (typeof DeviceOrientationEvent.requestPermission === 'function') {
Â Â Â Â Â Â Â Â DeviceOrientationEvent.requestPermission()
Â Â Â Â Â Â Â Â .then(response=>{
Â Â Â Â Â Â Â Â Â Â Â Â if(response==='granted'){
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â window.addEventListener("deviceorientation", handleOrientation, true);
Â Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â });
Â Â Â Â } else {
Â Â Â Â Â Â Â Â alert("Sensor otomatis aktif (Android)");
Â Â Â Â }
}
</script>
<script>
if ('serviceWorker' in navigator) {
Â Â Â Â navigator.serviceWorker.register('sw.js');
}
</script>
</body>
</html>
